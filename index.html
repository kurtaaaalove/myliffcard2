<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>我的 LINE 名片</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    .profile { border-radius: 50%; width: 120px; }
    .btn { background: #06c755; color: white; padding: 10px 20px; font-size: 16px; border: none; border-radius: 4px; margin-top: 20px; cursor: pointer; }
    .btn:disabled { background: #cccccc; cursor: not-allowed; }
  </style>
</head>
<body>
  <h1>我是 Kurt Wang</h1>
  <img class="profile" src="https://yourdomain.com/avatar.jpg" alt="Kurt 頭像"> <p>資深工程師 | 台灣</p>

  <button class="btn" id="shareBtn" disabled>分享給好友</button>

  <script>
    async function initializeLiff() {
      try {
        await liff.init({ liffId: "2007344981-yXozKWX0" });

        if (!liff.isLoggedIn()) {
          // 如果使用者未登入，引導他們登入
          // liff.login() 會重新導向到 LINE 登入頁面，
          // 登入成功後會再導回此頁面。
          // 導回後，liff.init() 會再次執行。
          alert('您需要登入 LINE 才能分享名片。將導向登入頁面。');
          liff.login({ redirectUri: window.location.href }); // redirectUri 確保登入後返回當前頁面
          // 在 liff.login() 之後，此函數的執行通常會因頁面跳轉而停止
          return;
        }

        // 使用者已登入，可以啟用分享按鈕並設定事件監聽器
        const shareBtn = document.getElementById('shareBtn');
        shareBtn.disabled = false; // 啟用按鈕

        shareBtn.addEventListener('click', () => {
          liff.shareTargetPicker([
            {
              type: "text",
              text: "這是我的 LINE 數位名片：https://liff.line.me/2007344981-yXozKWX0"
            }
          ]).catch(err => {
            console.error('Share Target Picker error:', err);
            alert('分享失敗: ' + err.toString());
          });
        });

      } catch (err) {
        console.error('LIFF Initialization failed:', err);
        alert('LIFF 初始化失敗: ' + err.toString());
        // 初始化失敗時，也可以禁用按鈕
        const shareBtn = document.getElementById('shareBtn');
        if (shareBtn) {
            shareBtn.textContent = 'LIFF 初始化失敗';
            shareBtn.disabled = true;
        }
      }
    }

    initializeLiff();
  </script>
</body>
</html>